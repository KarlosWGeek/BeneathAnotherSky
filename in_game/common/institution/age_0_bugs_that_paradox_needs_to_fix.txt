################################################################
#
# ADVANCES FILE DIRECTORY
#
################################################################
#
# This file consolidates all institutions into a single file due to a bug that causes the game not to load institutions properly if they are in multiple files.
# Only applies to new files with modded institutions for some reason. Let's all put our hands together and pray Paradox will fix it even if it only affects us modders.
# Use this directory to quickly navigate between different age sectors, by using Ctrl + F with the terms listed below (also include the # in the search). 
#
# AGE 1 - SOVEREIGNS
# AGE 2 - TIDES
# AGE 3 - EMBERS
# AGE 4 - DARKNESS
# AGE 5 - UNBINDING
# AGE 6 - TECHNOMANCY
#
################################################################
#
# AGE 1 - SOVEREIGNS
#
# Inspired by the European Late Middle Ages (roughly 13th-15th centuries) but with some fantasy elements, like magic and monsters.
# Only some human nations have access or a positive opinion of magic, the other races are either indifferent to it (orcs, halflings) or make extensive use of it (elves, dwarves).
# Tech tree should include major real-life innovations from the 1200-1400, alongside fantasy/speculative/hypothetical technology related to the magical-fantasy setting.
#
################################################################

# National Governments
national_governments_i = {
	age = age_1_sovereigns 
	
	
	can_spawn = {
		continent = continent:europe
		has_owner = yes
		num_pop_type:nobles > 0.1
	}
	promote_chance = {
		add = {
			value = num_pop_type:nobles
			multiply = 10
		}
	}
	
	
	#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = {
		value = institution_base_spread_from_friendly_neighbor_with_early
		add = {
			value = num_pop_type:nobles
			multiply = 0.5
		}
	}
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_early
	spread_from_any_import = institution_trade_spread_value_early
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_early
	spread_to_market_member = institution_spread_to_market_member_early
	
}

# Gunpowder
gunpowder_i = {
	age = age_1_sovereigns 
	
	
	can_spawn = {
		continent = continent:europe
		has_owner = yes
		num_pop_type:nobles > 0
	}
	
	promote_chance = {
		add = {
			value = num_pop_type:clergy
			multiply = 10
		}
	}
	
	#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_early
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_early
	spread_from_any_import = institution_trade_spread_value_early
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_early
	spread_to_market_member = institution_spread_to_market_member_early

}

# Gilded Ledgers
gilded_ledgers_i = {
	age = age_1_sovereigns	
	
	can_spawn = {
		OR = {
			AND = {
				has_game_rule = institution_spawn_fixed_historical
				this = location:genoa
			}
			AND = {
				has_game_rule = institution_spawn_random_city
				location_rank = location_rank:city
			}
			AND = {
				has_game_rule = institution_spawn_plausible
				has_owner = yes
				num_pop_type:burghers > 1.0
				custom_tooltip = {
					text = dominant_culture_is_owners_culture
					dominant_culture = owner.culture
				}
				OR = {
					continent = continent:europe
					sub_continent = sub_continent:north_africa
					sub_continent = sub_continent:middle_east
				}
				
				owner = {
					societal_value:capital_economy_vs_traditional_economy < -50
				}
			}
		}
	}

	promote_chance = {
		add = {
			value = average_location_literacy
		}
		add = {
			value = num_pop_type:burghers
			multiply = 10
		}
	}
	
	#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_early
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_early
	spread_from_any_import = institution_trade_spread_value_early
	spread_from_any_export = institution_trade_spread_value_early
	spread_from_was_possible_spawn = institution_spread_from_was_possible_spawn_early
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_early
	spread_to_market_member = institution_spread_to_market_member_early	
}

# Nature Magic
nature_magic_i = {
	age = age_1_sovereigns 
	
	
	can_spawn = {
		continent = continent:europe
		has_owner = yes
		num_pop_type:nobles > 0.1
	}
	promote_chance = {
		add = {
			value = num_pop_type:nobles
			multiply = 10
		}
	}
	
	
	#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = {
		value = institution_base_spread_from_friendly_neighbor_with_early
		add = {
			value = num_pop_type:nobles
			multiply = 0.5
		}
	}
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_early
	spread_from_any_import = institution_trade_spread_value_early
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_early
	spread_to_market_member = institution_spread_to_market_member_early
	
}

################################################################
#
# AGE 2 - TIDES
#
# Inspired by the Early Modern Period and the European Age of Discovery (roughly 15th-17th centuries) but the 'New World' is inhabited by fantasy races such as elves, dwarves, orcs, halflings, etc.
# Previously isolated parts of the world now become connected through trade, causing technological and magical interchange to happen, and laying the groundwork for globalization.
# Tech tree should include major real-life innovations from the 1400-1500, alongside fantasy/speculative/hypothetical technology related to the magical-fantasy setting.
#
################################################################

# Seafaring Cartography
seafaring_cartography_i = {
	age = age_2_tides 
	
	
	can_spawn = {
		OR = {
			AND = {
				has_game_rule = institution_spawn_random_city
				location_rank = location_rank:city
			}
			AND = {
				has_game_rule = institution_spawn_fixed_historical
				this = location:florence
			}
			AND = {
				has_game_rule = institution_spawn_plausible
				has_owner = yes
				OR = {
					area = area:emilia_area
					area = area:lombardy_area
					area = area:piemonte_area
					area = area:tuscany_area
					area = area:veneto_area
					area = area:liguria_area
				}
				OR = {
					location_rank = location_rank:city
					has_building_with_at_least_one_level = university
				}
				custom_tooltip = {
					text = dominant_culture_is_owners_culture
					dominant_culture = owner.culture
				}
			}
		}
	}
	

	promote_chance = {
		add = {
			value = average_location_literacy
		}
		add = {
			value = num_pop_type:burghers
			multiply = 10
		}
	}
	
	#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_early
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_early
	spread_from_any_import = institution_trade_spread_value_early
	spread_from_was_possible_spawn = institution_spread_from_was_possible_spawn_early
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_early
	spread_to_market_member = institution_spread_to_market_member_early
}

# Monster Taming
monster_taming_i = {
	age = age_2_tides 
	
	
	can_spawn = {
		OR = {
			AND = {
				has_game_rule = institution_spawn_fixed_historical
				this = location:genoa
			}
			AND = {
				has_game_rule = institution_spawn_random_city
				location_rank = location_rank:city
			}
			AND = {
				has_game_rule = institution_spawn_plausible
				has_owner = yes
				num_pop_type:burghers > 1.0
				custom_tooltip = {
					text = dominant_culture_is_owners_culture
					dominant_culture = owner.culture
				}
				OR = {
					continent = continent:europe
					sub_continent = sub_continent:north_africa
					sub_continent = sub_continent:middle_east
				}
				
				owner = {
					societal_value:capital_economy_vs_traditional_economy < -50
				}
			}
		}
	}

	promote_chance = {
		add = {
			value = average_location_literacy
		}
		add = {
			value = num_pop_type:burghers
			multiply = 10
		}
	}
	
	#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_early
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_early
	spread_from_any_import = institution_trade_spread_value_early
	spread_from_was_possible_spawn = institution_spread_from_was_possible_spawn_early
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_early
	spread_to_market_member = institution_spread_to_market_member_early	
}

# Word Printer
word_printer_i = {
	age = age_2_tides 
	
	
	can_spawn = {
		OR = {
			AND = {
				has_game_rule = institution_spawn_random_city
				location_rank = location_rank:city
			}
			AND = {
				has_game_rule = institution_spawn_fixed_historical
				this = location:paris
			}
			AND = {
				has_game_rule = institution_spawn_plausible
				continent = continent:europe
				has_owner = yes

				custom_tooltip = {
					text = dominant_culture_is_owners_culture
					dominant_culture = owner.culture
				}
				modifier:local_manpower > 0
				
				owner = {
					societal_value:quality_vs_quantity < -10
				}
			}
		}
	}
	promote_chance = {
		add = {
			value = average_location_literacy
		}
		add = {
			value = modifier:local_manpower
			multiply = 2
		}

	}
	
	#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_early
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_early
	spread_from_any_import = institution_trade_spread_value_early
	spread_from_was_possible_spawn = institution_spread_from_was_possible_spawn_early
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_early
	spread_to_market_member = institution_spread_to_market_member_early	
}

# Planetary Magic
planetary_magic_i = {
	age = age_2_tides 
	
	
	can_spawn = {
		OR = {
			AND = {
				has_game_rule = institution_spawn_random_city
				location_rank = location_rank:city
			}
			AND = {
				has_game_rule = institution_spawn_fixed_historical
				this = location:paris
			}
			AND = {
				has_game_rule = institution_spawn_plausible
				continent = continent:europe
				has_owner = yes

				custom_tooltip = {
					text = dominant_culture_is_owners_culture
					dominant_culture = owner.culture
				}
				modifier:local_manpower > 0
				
				owner = {
					societal_value:quality_vs_quantity < -10
				}
			}
		}
	}
	promote_chance = {
		add = {
			value = average_location_literacy
		}
		add = {
			value = modifier:local_manpower
			multiply = 2
		}

	}
	
	#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_early
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_early
	spread_from_any_import = institution_trade_spread_value_early
	spread_from_was_possible_spawn = institution_spread_from_was_possible_spawn_early
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_early
	spread_to_market_member = institution_spread_to_market_member_early	
}

################################################################
#
# AGE 3 - EMBERS
#
# Inspired by the Early Modern Period and the Age of Reformation (roughly 16th to 17th century), but with far more fantasy elements to it, as now magic is much more widespread and a greater understanding of the world is developing.
# Interdimensional portals to a dimension similar to Hell are open, and in this dimension there are many unique/exotic resources that will further expand the possibilities of magic and technology.
# Tech tree should include major real-life innovations from the 1500-1600, alongside fantasy/speculative/hypothetical technology related to the magical-fantasy setting.
#
################################################################

# Infernal Gatecraft
infernal_gatecraft_i = {
	age = age_3_embers 


	can_spawn = {
		OR = {
			AND = {
				has_game_rule = institution_spawn_random_city
				location_rank = location_rank:city
			}
			AND = {
				has_game_rule = institution_spawn_fixed_historical
				this = location:sevilla
			}
			AND = {
				has_game_rule = institution_spawn_plausible
				
				OR = {
					sub_continent = sub_continent:western_europe
					sub_continent = sub_continent:north_africa
				}
				has_owner = yes
				is_port = yes
				num_pop_type:burghers >= 2.0
				dominant_culture = owner.culture
				owner = {
					OR = {
						has_discovered_area = area:azores_area
						has_discovered_area = area:canary_islands_area
						has_discovered_area = area:south_macaronesia_area
					}
				}
			}
		}
	}

	promote_chance = {
		add = {
			value = average_location_literacy
		}
		add = {
			value = num_pop_type:burghers
			multiply = 10
		}
	}
	
	#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_mid
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_mid
	spread_from_any_import = institution_trade_spread_value_mid
	spread_from_was_possible_spawn = institution_spread_from_was_possible_spawn_mid
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_mid
	spread_to_market_member = institution_spread_to_market_member_mid
}

# Interdimensional Outposts
interdimensional_outposts_i = { 
	age = age_3_embers 
	
	
	can_spawn = {
		OR = {
			AND = {
				has_game_rule = institution_spawn_random_city
				location_rank = location_rank:city
			}
			AND = {
				has_game_rule = institution_spawn_fixed_historical
				this = location:mainz
			}
			AND = {
				has_game_rule = institution_spawn_plausible
				owner ?= {
					produced_in_country:paper > 5
				}
				has_institution = institution:renaissance
				
				num_pop_type:burghers > 1
				has_building = building_type:university	
				
				owner = {
					societal_value:traditionalist_vs_innovative > 20
				}
			}
		}
		
	}

	promote_chance = {
		add = {
			value = average_location_literacy
		}
		add = {
			value = average_location_literacy #Is there a market for printed things?
			multiply = 10
		}
	}
	
	#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_mid
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_mid
	spread_from_any_import = institution_trade_spread_value_mid
	spread_from_was_possible_spawn = institution_spread_from_was_possible_spawn_mid
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_mid
	spread_to_market_member = institution_spread_to_market_member_mid	
}

# Dreadhull
dreadhull_i = {
	age = age_3_embers 
	
	
	can_spawn = {
		OR = {
			AND = {
				has_game_rule = institution_spawn_random_city
				location_rank = location_rank:city
			}
			AND = {
				has_game_rule = institution_spawn_fixed_historical
				this = location:innsbruck
			}
			AND = {
				has_game_rule = institution_spawn_plausible
				has_institution = institution:professional_armies

				OR = {
					continent = continent:europe
					sub_continent = sub_continent:north_africa
				}

				owner ?= {
					army_tradition > 20
					has_advance = gunpowder_advance
					has_advance = professional_armies_advance
				}
			
				modifier:local_manpower > 0
				
				owner = {
					societal_value:land_vs_naval < -20
				}
			}
		}
		
	}
	

	promote_chance = {
		add = {
			value = average_location_literacy
		}
		add = {
			value = modifier:local_manpower
			multiply = 10
		}
	}
	
	#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_mid
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_mid
	spread_from_any_import = institution_trade_spread_value_mid
	spread_from_was_possible_spawn = institution_spread_from_was_possible_spawn_mid
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_mid
	spread_to_market_member = institution_spread_to_market_member_mid
}

# Vulkarite Metallurgy
vulkarite_metallurgy_i = {
	age = age_3_embers 
	
	
	can_spawn = {
		OR = {
			AND = {
				has_game_rule = institution_spawn_random_city
				location_rank = location_rank:city
			}
			AND = {
				has_game_rule = institution_spawn_fixed_historical
				this = location:innsbruck
			}
			AND = {
				has_game_rule = institution_spawn_plausible
				has_institution = institution:professional_armies

				OR = {
					continent = continent:europe
					sub_continent = sub_continent:north_africa
				}

				owner ?= {
					army_tradition > 20
					has_advance = gunpowder_advance
					has_advance = professional_armies_advance
				}
			
				modifier:local_manpower > 0
				
				owner = {
					societal_value:land_vs_naval < -20
				}
			}
		}
		
	}
	

	promote_chance = {
		add = {
			value = average_location_literacy
		}
		add = {
			value = modifier:local_manpower
			multiply = 10
		}
	}
	
	#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_mid
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_mid
	spread_from_any_import = institution_trade_spread_value_mid
	spread_from_was_possible_spawn = institution_spread_from_was_possible_spawn_mid
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_mid
	spread_to_market_member = institution_spread_to_market_member_mid
}

################################################################
#
# AGE 4 - DARKNESS
#
# Inspired by the Early Modern Period and the Age of Absolutism (roughly 17th to 18th century), but with far more fantasy elements to it, as now magic is much more widespread and a greater understanding of the world is developing.
# The entire world seems to be covered in a 'magical veil of darkness' that makes it permanently night-time and greatly slows down the growth of farming crops and other natural resources. Tech and magic development will be focused on dealing with the negative effects while looking for a solution.
# Tech tree should include major real-life innovations from 1600-1700, alongside fantasy/speculative/hypothetical technology related to the magical-fantasy setting.
#
################################################################

# Binding Charter
binding_charter_i = {
	age = age_4_darkness 
	
	
	can_spawn = {
		OR = {
			AND = {
				has_game_rule = institution_spawn_random_city
				location_rank = location_rank:city
			}
			AND = {
				has_game_rule = institution_spawn_fixed_historical
				this = location:augsburg
			}
			AND = {
				has_game_rule = institution_spawn_plausible
				OR = {
					continent = continent:europe
					sub_continent = sub_continent:north_africa
				}

				has_owner = yes
				has_building_with_at_least_one_level = printing_press_shop
				
				OR = {
					location_rank = location_rank:town
					location_rank = location_rank:city
				}
				
				dominant_religion = owner.religion
				dominant_religion = religion:catholic
				
				
						
				owner = {
					societal_value:spiritualist_vs_humanist < -25
				}
			}
		}
	
	
	}
	promote_chance = {
		add = {
			if = {
				limit = {
					num_pop_type:clergy > 10
				}
				value = average_location_literacy
				multiply = 10
			}
		}
		add = {
			value = num_pop_type:clergy
			multiply = 5
		}
	}
	
	#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_mid
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_mid
	spread_from_any_import = institution_trade_spread_value_mid
	spread_from_was_possible_spawn = institution_spread_from_was_possible_spawn_mid
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_mid
	spread_to_market_member = institution_spread_to_market_member_mid	
}

# Worthbound
worthbound_i = {
	age = age_4_darkness 
	
	can_spawn = {
		OR = {
			AND = {
				has_game_rule = institution_spawn_random_city
				location_rank = location_rank:city
			}
			AND = {
				has_game_rule = institution_spawn_fixed_historical
				this = location:lisbon
			}
			AND = {
				has_game_rule = institution_spawn_plausible
				has_institution = institution:banking
				has_institution = institution:new_world


				OR = {
					continent = continent:europe
					sub_continent = sub_continent:north_africa
				}

				is_market_center = yes
				location_rank = location_rank:city
				market = {
					total_goods_value_traded > 500
				}
			}
		}
	}
	

	promote_chance = {
		add = {
			value = average_location_literacy
		}

		add = {
			value = num_pop_type:burghers
			multiply = 5
		
		}
		add = {
			if = {
				limit = { is_port = yes }
				value = 5
			}
		}
	}
	
	#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_mid
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_mid
	spread_from_any_import = institution_trade_spread_value_mid
	spread_from_was_possible_spawn = institution_spread_from_was_possible_spawn_mid
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_mid
	spread_to_market_member = institution_spread_to_market_member_mid	
}

# Darktide
darktide_i = {
	age = age_4_darkness 
	
	can_spawn = {
		OR = {
			AND = {
				has_game_rule = institution_spawn_random_city
				location_rank = location_rank:city
			}
			AND = {
				has_game_rule = institution_spawn_fixed_historical
				this = location:constantinople
			}
			AND = {
				has_game_rule = institution_spawn_plausible
				has_institution = institution:professional_armies

				OR = {
					continent = continent:europe
					sub_continent = sub_continent:north_africa
				}

				has_building_with_at_least_one_level = gun_smith
				has_building_with_at_least_one_level = tools_guild
				
				owner = {
					societal_value:offensive_vs_defensive < -20
				}
			}
		}
	}
	
	promote_chance = {
		add = {
			value = average_location_literacy
		}
		add = {
			value = modifier:local_manpower
			multiply = 10
		}
	}
	
	#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_mid
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_mid
	spread_from_any_import = institution_trade_spread_value_mid
	spread_from_was_possible_spawn = institution_spread_from_was_possible_spawn_mid
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_mid
	spread_to_market_member = institution_spread_to_market_member_mid
}

# Great Unveiling
great_unveiling_i = {
	age = age_4_darkness 
	
	can_spawn = {
		OR = {
			AND = {
				has_game_rule = institution_spawn_random_city
				location_rank = location_rank:city
			}
			AND = {
				has_game_rule = institution_spawn_fixed_historical
				this = location:constantinople
			}
			AND = {
				has_game_rule = institution_spawn_plausible
				has_institution = institution:professional_armies

				OR = {
					continent = continent:europe
					sub_continent = sub_continent:north_africa
				}

				has_building_with_at_least_one_level = gun_smith
				has_building_with_at_least_one_level = tools_guild
				
				owner = {
					societal_value:offensive_vs_defensive < -20
				}
			}
		}
	}
	
	promote_chance = {
		add = {
			value = average_location_literacy
		}
		add = {
			value = modifier:local_manpower
			multiply = 10
		}
	}
	
	#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_mid
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_mid
	spread_from_any_import = institution_trade_spread_value_mid
	spread_from_was_possible_spawn = institution_spread_from_was_possible_spawn_mid
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_mid
	spread_to_market_member = institution_spread_to_market_member_mid
}

################################################################
#
# AGE 5 - UNBINDING
#
# Inspired by the Early Modern Period and the Age of Revolutions (roughly 18th to 19th century), but with far more fantasy elements to it, as now magic is much more widespread and a greater understanding of the world is developing.
# Similar to the Age of Embers, portals to a dimension similar to heaven open, with even more powerful resources and magic. But it's way more dangerous, with common animals having god-like levels of magical power.
# Tech tree should include major real-life innovations from 1700-1800, alongside fantasy/speculative/hypothetical technology related to the magical-fantasy setting.
#
################################################################

# Heavenly Gatecraft
heavenly_gatecraft_i = {
	age = age_5_unbinding 
	
	
	can_spawn = {
		OR = {
			AND = {
				has_game_rule = institution_spawn_random_city
				location_rank = location_rank:city
			}
			AND = {
				has_game_rule = institution_spawn_fixed_historical
				this = location:derby
			}
			AND = {
				has_game_rule = institution_spawn_plausible
				has_institution = institution:banking

				OR = {
					continent = continent:europe
					sub_continent = sub_continent:north_africa
				}

				num_pop_type:burghers > 20
				total_building_levels > 80
				
				owner = {
					societal_value:capital_economy_vs_traditional_economy < -30
				}
			}
		}
		
	}
	
	
	promote_chance = {
		add = { #Any higher level production building - some of these require you to have embraced it already, but not all.
			if = {
				limit = {
					NOR = {
						has_building = building_type:cannon_foundry
						has_building = building_type:firearms_manufactory
						has_building = building_type:weapon_manufactory
						has_building = building_type:fine_cloth_manufactory
						has_building = building_type:fine_cloth_manufactory
						has_building = building_type:cloth_manufactory
						has_building = building_type:paper_guild
						has_building = building_type:printing_press_shop
						has_building = building_type:glassworks
						has_building = building_type:perfumery
						has_building = building_type:porcelain_manufactory
						has_building = building_type:tannery_manufactory
						has_building = building_type:putrefaction_works
						has_building = building_type:naval_supplies_manufactory
					}
				}
				value = num_pop_type:burghers
				multiply = 10
			}
			else = { #Ie we have one of the higher level production buildings
				value = num_pop_type:burghers
				multiply = 25
			}
		}
	}


	#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_late
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_late
	spread_from_any_import = institution_trade_spread_value_late
	spread_from_was_possible_spawn = institution_spread_from_was_possible_spawn_late
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_late
	spread_to_market_member = institution_spread_to_market_member_late	
	
}

# Awakening
awakening_i = {
	age = age_5_unbinding 
	
	
	can_spawn = {
		OR = {
			AND = {
				has_game_rule = institution_spawn_random_city
				location_rank = location_rank:city
			}
			AND = {
				has_game_rule = institution_spawn_fixed_historical
				this = location:cambridge
			}
			AND = {
				has_game_rule = institution_spawn_plausible
				has_institution = institution:printing_press

				OR = {
					continent = continent:europe
					sub_continent = sub_continent:north_africa
				}

		
				has_building = building_type:university	
				average_location_literacy > 30
				
				owner = {
					societal_value:traditionalist_vs_innovative >= 20
				}
			}
		}
		
	}
	

	
	promote_chance = {
		add = {
			value = num_pop_type:clergy
			multiply = 10
		}
		add = {
			value = num_pop_type:burghers
			multiply = 10
		}
	}
	
	#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_late
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_late
	spread_from_any_import = institution_trade_spread_value_late
	spread_from_was_possible_spawn = institution_spread_from_was_possible_spawn_late
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_late
	spread_to_market_member = institution_spread_to_market_member_late	
}

# Storm Engine
storm_engine_i = {
	age = age_5_unbinding 
	
	
	can_spawn = {
		OR = {
			AND = {
				has_game_rule = institution_spawn_random_city
				location_rank = location_rank:city
			}
			AND = {
				has_game_rule = institution_spawn_fixed_historical
				this = location:stockholm
			}
			AND = {
				has_game_rule = institution_spawn_plausible
				has_institution = institution:pike_and_shot
				has_institution = institution:artillery_institution

				OR = {
					continent = continent:europe
					sub_continent = sub_continent:north_africa
				}

				is_capital = yes
				population > 30
				owner = {
					yearly_manpower > 2
					societal_value:offensive_vs_defensive < -20
				}
			}
		}
		
	}


	promote_chance = {
		add = {
			value = modifier:local_manpower
			multiply = 25
		}
	}
	
	#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_late
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_late
	spread_from_any_import = institution_trade_spread_value_late
	spread_from_was_possible_spawn = institution_spread_from_was_possible_spawn_late
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_late
	spread_to_market_member = institution_spread_to_market_member_late	
}

# Divine Magic
divine_magic_i = {
	age = age_5_unbinding 
	
	
	can_spawn = {
		OR = {
			AND = {
				has_game_rule = institution_spawn_random_city
				location_rank = location_rank:city
			}
			AND = {
				has_game_rule = institution_spawn_fixed_historical
				this = location:stockholm
			}
			AND = {
				has_game_rule = institution_spawn_plausible
				has_institution = institution:pike_and_shot
				has_institution = institution:artillery_institution

				OR = {
					continent = continent:europe
					sub_continent = sub_continent:north_africa
				}

				is_capital = yes
				population > 30
				owner = {
					yearly_manpower > 2
					societal_value:offensive_vs_defensive < -20
				}
			}
		}
		
	}


	promote_chance = {
		add = {
			value = modifier:local_manpower
			multiply = 25
		}
	}
	
	#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_late
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_late
	spread_from_any_import = institution_trade_spread_value_late
	spread_from_was_possible_spawn = institution_spread_from_was_possible_spawn_late
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_late
	spread_to_market_member = institution_spread_to_market_member_late	
}

################################################################
#
# AGE 6 - TECHNOMANCY
#
# Inspired by the Early Modern Period and the Age of Revolutions (roughly 18th to 19th century), but with far more fantasy elements to it, as now magic is much more widespread and a greater understanding of the world is developing.
# The ultimate culmination of technological and magical development, using resources from all three dimensional planes: technomancy. Machines and tools capable of using magic, either with assistance or remotely. Heavy arcanepunk, steampunk and magitech vibes, although it's still in its 19th century stage.
# Tech tree should include major real-life innovations from 1800-1900, alongside fantasy/speculative/hypothetical technology related to the magical-fantasy setting.
#
################################################################

# Technomancy
technomancy_i = {
	age = age_6_technomancy
	
	
	can_spawn = {
		OR = {
			AND = {
				has_game_rule = institution_spawn_random_city
				location_rank = location_rank:city
			}
			AND = {
				has_game_rule = institution_spawn_fixed_historical
				this = location:paris
			}
			AND = {
				has_game_rule = institution_spawn_plausible
				has_institution = institution:scientific_revolution

				OR = {
					continent = continent:europe
					sub_continent = sub_continent:north_africa
				}

				has_building_with_at_least_one_level = university
				average_location_literacy > 30
				
				
				owner = {
					societal_value:traditionalist_vs_innovative > 20
				}
			}
		}
		
	}

	
	promote_chance = {
		add = {
			value = average_location_literacy
		}

		add = {
			value = num_pop_type:burghers
			multiply = 10
		}
		add = {
			value = num_pop_type:nobles
			multiply = 10
		}
	}
	
	#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_late
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_late
	spread_from_any_import = institution_trade_spread_value_late
	spread_from_was_possible_spawn = institution_spread_from_was_possible_spawn_late
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_late
	spread_to_market_member = institution_spread_to_market_member_late

}

# Aetherium
aetherium_i = {
	age = age_6_technomancy 
	
	
	can_spawn = {
		OR = {
			AND = {
				has_game_rule = institution_spawn_random_city
				location_rank = location_rank:city
			}
			AND = {
				has_game_rule = institution_spawn_fixed_historical
				this = location:blackburn
			}
			AND = {
				has_game_rule = institution_spawn_plausible
				has_institution = institution:manufactories

				OR = {
					continent = continent:europe
					sub_continent = sub_continent:north_africa
				}

				num_pop_type:burghers > 20
				total_building_levels > 120
				
				owner = {
					societal_value:capital_economy_vs_traditional_economy < -30
				}
			}
		}

	}
	
	promote_chance = {
		add = {
			value = average_location_literacy
		}

		add = {
			value = owner.total_population
		}
	}
	
		#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_late
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_late
	spread_from_any_import = institution_trade_spread_value_late
	spread_from_was_possible_spawn = institution_spread_from_was_possible_spawn_late
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_late
	spread_to_market_member = institution_spread_to_market_member_late

}

# Airship
airship_i = {
	age = age_6_technomancy
	
	
	can_spawn = {
		OR = {
			AND = {
				has_game_rule = institution_spawn_random_city
				location_rank = location_rank:city
			}
			AND = {
				has_game_rule = institution_spawn_fixed_historical
				this = location:paris
			}
			AND = {
				has_game_rule = institution_spawn_plausible
				has_institution = institution:military_revolution
				owner ?= { capital = root }
				population > 200
				
				owner = {
					societal_value:quality_vs_quantity > 0
				}
			}
		}
		
	}
	
	promote_chance = {
		add = {
			value = average_location_literacy
		}

		add = num_pop_type:peasants
	}
		#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_late
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_late
	spread_from_any_import = institution_trade_spread_value_late
	spread_from_was_possible_spawn = institution_spread_from_was_possible_spawn_late
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_late
	spread_to_market_member = institution_spread_to_market_member_late

}

# Lightning Current
lightning_current_i = {
	age = age_6_technomancy
	
	
	can_spawn = {
		OR = {
			AND = {
				has_game_rule = institution_spawn_random_city
				location_rank = location_rank:city
			}
			AND = {
				has_game_rule = institution_spawn_fixed_historical
				this = location:paris
			}
			AND = {
				has_game_rule = institution_spawn_plausible
				has_institution = institution:military_revolution
				owner ?= { capital = root }
				population > 200
				
				owner = {
					societal_value:quality_vs_quantity > 0
				}
			}
		}
		
	}
	
	promote_chance = {
		add = {
			value = average_location_literacy
		}

		add = num_pop_type:peasants
	}
		#hardcoded spreads for optimisations..
	spread_from_friendly_coast_border_location = institution_base_spread_from_friendly_neighbor_with_late
	spread_from_any_coast_border_location = institution_base_spread_from_neighbor_with_late
	spread_from_any_import = institution_trade_spread_value_late
	spread_from_was_possible_spawn = institution_spread_from_was_possible_spawn_late
	spread_scale_on_control_if_owner_embraced = 2
	spread_embraced_to_capital = institution_total_embraced_to_capital_late
	spread_to_market_member = institution_spread_to_market_member_late

}